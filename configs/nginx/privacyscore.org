server {
  listen 80;
  listen [::]:80;

  server_name privacyscore.org;

  include acme.conf;

  return 301 https://$server_name$request_uri;

  access_log /var/log/nginx/privacyscore.org.access.log;
  error_log /var/log/nginx/privacyscore.org.error.log;
}

server {
  listen 443;
  listen [::]:443;

  server_name privacyscore.org;

  include ssl.conf;
  ssl_certificate /etc/letsencrypt/certs/privacyscore.org/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/certs/privacyscore.org/privkey.pem;

  include acme.conf;
  #include security.conf;

  location /opening/ {
   return 302 https://$server_name/;
  }

  location /static {
    alias /var/www/privacyscore.org;
  }

  location /media {
    alias /var/www/media.privacyscore.org;
  }

  location / {
    uwsgi_pass 127.0.0.1:3829;
    include uwsgi_params;
    #proxy_pass http://127.0.0.1:3829;
    #include proxy_params;
  }

  access_log /var/log/nginx/privacyscore.org.access.log;
  error_log /var/log/nginx/privacyscore.org.error.log;

  # HSTS (15768000 seconds = 6 months)
  add_header Strict-Transport-Security "max-age=15768000; includeSubDomains; preload";

  # Content-Security-Policy as recorded with Mozilla Laboratory Firefox Add-on
  add_header Content-Security-Policy "default-src 'none'; font-src 'self'; img-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'";

  # This header enables the Cross-site scripting (XSS) filter built into most recent web browsers.
  # It's usually enabled by default anyway, so the role of this header is to re-enable the filter for
  # this particular website if it was disabled by the user.
  # https://www.owasp.org/index.php/List_of_useful_HTTP_headers
  add_header X-XSS-Protection "1; mode=block";

  # config to don't allow the browser to render the page inside an frame or iframe
  # and avoid clickjacking http://en.wikipedia.org/wiki/Clickjacking
  # if you need to allow [i]frames, you can use SAMEORIGIN or even set an uri with ALLOW-FROM uri
  # https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options
  add_header X-Frame-Options SAMEORIGIN;

  # when serving user-supplied content, include a X-Content-Type-Options: nosniff header along with the Content-Type: header,
  # to disable content-type sniffing on some browsers.
  # https://www.owasp.org/index.php/List_of_useful_HTTP_headers
  # currently suppoorted in IE > 8 http://blogs.msdn.com/b/ie/archive/2008/09/02/ie8-security-part-vi-beta-2-update.aspx
  # http://msdn.microsoft.com/en-us/library/ie/gg622941(v=vs.85).aspx
  # 'soon' on Firefox https://bugzilla.mozilla.org/show_bug.cgi?id=471020
  add_header X-Content-Type-Options nosniff;

  add_header Referrer-Policy no-referrer;
}